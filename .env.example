# =============================================================================
# PostgreSQL Unified Collector - Environment Configuration
# =============================================================================

# =============================================================================
# POSTGRESQL DATABASE CONFIGURATION
# =============================================================================

# Primary database connection (choose one method)
# Method 1: Connection string (recommended)
POSTGRES_CONNECTION_STRING=postgresql://postgres:password@localhost:5432/postgres

# Method 2: Individual connection parameters (alternative to connection string)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USERNAME=postgres
POSTGRES_PASSWORD=password
POSTGRES_DATABASE=postgres

# Database list for multi-database monitoring (comma-separated)
POSTGRES_DATABASES=postgres,application_db

# Connection pool settings
POSTGRES_MAX_CONNECTIONS=10
POSTGRES_CONNECT_TIMEOUT_SECS=30

# SSL Configuration (production environments)
POSTGRES_SSLMODE=prefer
# POSTGRES_SSLCERT=/path/to/client.crt
# POSTGRES_SSLKEY=/path/to/client.key
# POSTGRES_SSLROOTCERT=/path/to/ca.crt

# =============================================================================
# NEW RELIC CONFIGURATION
# =============================================================================

# New Relic API credentials
NEW_RELIC_API_KEY=NRAK-your-api-key-here
NEW_RELIC_ACCOUNT_ID=1234567
NEW_RELIC_REGION=US

# Alternative: License key (for Infrastructure integration)
NEW_RELIC_LICENSE_KEY=your-license-key-here

# Regional endpoints (automatically set based on NEW_RELIC_REGION)
# NEW_RELIC_OTLP_ENDPOINT=https://otlp.nr-data.net:4318
# NEW_RELIC_API_ENDPOINT=https://api.newrelic.com

# =============================================================================
# COLLECTION CONFIGURATION
# =============================================================================

# Collection behavior
COLLECTION_INTERVAL_SECS=30
COLLECTION_MODE=hybrid  # nri, otlp, or hybrid

# Query monitoring thresholds
QUERY_MONITORING_COUNT_THRESHOLD=100
QUERY_MONITORING_RESPONSE_TIME_THRESHOLD=1000
MAX_SLOW_QUERIES=1000

# Extended metrics
ENABLE_EXTENDED_METRICS=true
ENABLE_ASH=true
ENABLE_EBPF=false

# Active Session History (ASH) configuration
ASH_SAMPLE_INTERVAL_SECS=5
ASH_RETENTION_HOURS=24
ASH_MAX_MEMORY_MB=100

# Query text sanitization
SANITIZE_QUERY_TEXT=true
SANITIZATION_MODE=smart  # none, smart, or full

# =============================================================================
# OUTPUT CONFIGURATION
# =============================================================================

# New Relic Infrastructure (NRI) output
NRI_ENABLED=true
NRI_ENTITY_KEY=${HOSTNAME}:${POSTGRES_PORT}
NRI_INTEGRATION_NAME=com.newrelic.postgresql

# OpenTelemetry Protocol (OTLP) output
OTLP_ENABLED=true
OTLP_ENDPOINT=${NEW_RELIC_OTLP_ENDPOINT}
OTLP_PROTOCOL=http  # http or grpc
OTLP_COMPRESSION=gzip
OTLP_TIMEOUT_SECS=30

# OTLP Headers (for authentication)
OTLP_HEADERS=Api-Key=${NEW_RELIC_API_KEY}

# =============================================================================
# PGBOUNCER MONITORING (OPTIONAL)
# =============================================================================

# PgBouncer integration
PGBOUNCER_ENABLED=false
PGBOUNCER_ADMIN_CONNECTION_STRING=postgresql://pgbouncer:password@localhost:6432/pgbouncer
PGBOUNCER_COLLECTION_INTERVAL_SECS=30

# =============================================================================
# HEALTH AND MONITORING
# =============================================================================

# Health check endpoints
HEALTH_ENABLED=true
HEALTH_BIND_ADDRESS=0.0.0.0:8080
HEALTH_INCLUDE_METRICS=true

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level and format
LOG_LEVEL=info  # trace, debug, info, warn, error
LOG_FORMAT=json  # json or pretty
LOG_OUTPUT=stdout  # stdout, stderr, or file path

# =============================================================================
# PERFORMANCE AND SECURITY
# =============================================================================

# Performance tuning
MAX_MEMORY_MB=500
WORKER_THREADS=0  # 0 = auto-detect
BLOCKING_THREADS=4

# Security settings
REQUIRE_SSL=false
VALIDATE_CERTIFICATES=true
MASK_CREDENTIALS_IN_LOGS=true

# =============================================================================
# DEVELOPMENT AND DEBUGGING
# =============================================================================

# Development features (set to false in production)
ENABLE_DEBUG_ENDPOINTS=false
ENABLE_QUERY_LOGGING=false
ENABLE_METRICS_DUMP=false

# =============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# =============================================================================

# Environment identifier (for resource attributes)
ENVIRONMENT=development  # development, staging, production
SERVICE_NAME=postgres-collector
SERVICE_VERSION=1.0.0
DEPLOYMENT_REGION=us-east-1

# =============================================================================
# ADVANCED CONFIGURATION
# =============================================================================

# Sampling configuration
SAMPLING_MODE=fixed  # fixed or adaptive
BASE_SAMPLE_RATE=1.0

# Multi-instance monitoring (comma-separated instance names)
# INSTANCES=primary,replica1,replica2

# Custom resource attributes
RESOURCE_ATTRIBUTES=service.name=${SERVICE_NAME},service.version=${SERVICE_VERSION},environment=${ENVIRONMENT}

# =============================================================================
# CONTAINER/KUBERNETES SPECIFIC
# =============================================================================

# Container environment
HOSTNAME=${HOSTNAME}
POD_NAME=${POD_NAME}
NODE_NAME=${NODE_NAME}
NAMESPACE=${NAMESPACE}

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Experimental features
EXPERIMENTAL_QUERY_OPTIMIZATION=false
EXPERIMENTAL_COMPRESSION=false
EXPERIMENTAL_CACHING=false

# Beta features
BETA_ENHANCED_METRICS=false
BETA_SMART_SAMPLING=false
BETA_ADAPTIVE_INTERVALS=false

# =============================================================================
# INTEGRATION TESTING
# =============================================================================

# Test environment overrides (used by integration tests)
# TEST_MODE=false
# MOCK_DATABASE_RESPONSES=false
# SIMULATE_ERRORS=false